<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Juliusagosto — Portal (Sorteio + Luta + Campanha)</title>

  <style>
    :root{
      --bg0:#0e0506;
      --bg1:#1a0708;
      --bg2:#260b0d;
      --ink:#fff1f1;
      --muted: rgba(255,241,241,.78);
      --red:#ff1a1a;
      --darkRed:#9a0b10;
      --accent:#cf6aff;
      --soft:#1d0a0c;
      --round: 14px;
      --sans: system-ui,-apple-system,Segoe UI,Arial,sans-serif;
      --mono: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      --shadow: 0 22px 60px rgba(0,0,0,.55);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background: radial-gradient(1100px 900px at 14% 0%, #3a0c10 0%, rgba(58,12,16,0) 64%),
                  radial-gradient(980px 860px at 92% 8%, #1a0708 0%, rgba(26,7,8,0) 68%),
                  linear-gradient(135deg, var(--bg0), var(--bg2));
      overflow-x:hidden;
    }

    /* topo fixo */
    header{
      position: sticky;
      top: 0;
      z-index: 20;
      backdrop-filter: blur(7px);
      background: linear-gradient(180deg, rgba(16,5,6,.98), rgba(16,5,6,.86));
      border-bottom: 1px solid rgba(255,26,26,.32);
      box-shadow: 0 18px 46px rgba(0,0,0,.55);
      padding: 12px 12px 10px;
    }
    .title{ margin: 0; font-weight: 980; letter-spacing: .2px; font-size: 20px; text-align:center; }
    .slogan{ margin: 6px auto 0; max-width: 980px; font-size: 13px; line-height: 1.45; color: rgba(255,241,241,.9); text-align:center; }
    .slogan b{ color: #ffffff; }

    nav{ display:flex; justify-content:center; gap: 10px; flex-wrap: wrap; margin-top: 10px; }

    .tab{
      border: 0;
      cursor: pointer;
      border-radius: 999px;
      padding: 8px 12px;
      font-weight: 980;
      letter-spacing: .18px;
      background: #160607;
      color: var(--ink);
      border: 1px solid rgba(255,26,26,.35);
      box-shadow: 0 16px 34px rgba(0,0,0,.45);
      transition: transform .12s ease, background .18s ease;
    }
    .tab:hover{ transform: scale(1.06); background: #20090b; }
    .tab:active{ transform: scale(.98); }

    main{ max-width: 1040px; margin: 0 auto; padding: 14px 12px 28px; }

    /* painel de cada aba */
    .panel{
      display: none;
      border-radius: var(--round);
      background: linear-gradient(180deg, rgba(34,9,11,.92), rgba(18,5,6,.92));
      border: 1px solid rgba(255,26,26,.28);
      box-shadow: var(--shadow);
      overflow: hidden;
      animation: pop .18s ease-out;
    }
    .panel.active{ display: block; }
    @keyframes pop{ from{ opacity: 0; transform: translateY(6px);} to{ opacity:1; transform: translateY(0);} }

    .panelTop{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,26,26,.22);
      background: linear-gradient(90deg, rgba(255,26,26,.12), rgba(207,106,255,.12));
      display:flex; gap: 10px; flex-wrap: wrap; justify-content: space-between; align-items: center;
    }
    .chip{
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .22px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(12,4,5,.55);
    }

    .panelBody{ padding: 12px; }

    .grid2{ display:grid; gap: 10px; grid-template-columns: 1fr; }
    @media (min-width: 760px){ .grid2{ grid-template-columns: 1fr 1fr; } }

    .box{
      border-radius: 12px;
      border: 1px solid rgba(255,26,26,.22);
      background: rgba(14,5,6,.48);
      padding: 10px;
    }

    .label{ font-weight: 980; letter-spacing: .18px; font-size: 13px; }

    input{
      width: 100%;
      padding: 9px 10px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.08);
      color: var(--ink);
      outline: none;
    }

    .btn{
      border: 0;
      cursor: pointer;
      border-radius: 10px;
      padding: 9px 12px;
      font-weight: 990;
      letter-spacing: .18px;
      background: linear-gradient(90deg, #ff1a1a, #cf6aff);
      color: #130506;
      box-shadow: 0 16px 30px rgba(0,0,0,.5);
      transition: transform .12s ease, filter .18s ease;
      margin-top: 8px;
    }
    .btn:hover{ filter: brightness(1.08); transform: scale(1.03); }
    .btn:active{ transform: scale(.98); }

    .muted{ color: rgba(255,241,241,.8); font-size: 13px; line-height: 1.55; }

    .result{
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.08);
      padding: 10px;
    }

    .mini{ font-family: var(--mono); font-size: 11px; letter-spacing: .2px; color: rgba(255,241,241,.8); }

    /* efeito "sharingan" fake (circular) para clique em link e também pode ser usado em botões */
    .share-veil{
      position: fixed;
      inset: 0;
      z-index: 50;
      background: radial-gradient(1000px 700px at 50% 12%, rgba(255,26,26,.18), rgba(0,0,0,0) 70%),
                  rgba(0,0,0,.55);
      display: none;
      align-items: center;
      justify-content: center;
    }
    .share-veil.active{ display:flex; }
    .share-ring{
      width: 120px; height: 120px;
      border-radius: 999px;
      border: 6px solid rgba(255,255,255,.22);
      box-shadow: 0 0 22px rgba(255,26,26,.35);
      position: relative;
      animation: ring 700ms linear;
    }
    .share-ring::before{
      content:"";
      position:absolute;
      inset: 14px;
      border-radius: 999px;
      border: 6px solid rgba(255,26,26,.55);
    }
    .share-ring::after{
      content:"";
      position:absolute;
      inset: 38px;
      border-radius: 999px;
      background: rgba(255,255,255,.22);
    }
    @keyframes ring{
      from{ transform: rotate(0deg) scale(.9); opacity: .0; }
      to{ transform: rotate(360deg) scale(1); opacity: 1; }
    }

    /* "rank badge" */
    .rank{
      display:inline-flex;
      gap: 6px;
      align-items: center;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(16,5,6,.62);
      font-family: var(--mono);
      font-size: 11px;
      letter-spacing: .2px;
    }
  </style>
</head>

<body>
  <header>
    <div class="title">Juliusagosto — Portal (Sorteio · Luta · Campanha)</div>
    <div class="slogan">
      <b>“Você só vai realizar seus sonhos se nunca desistir e tentar mais uma vez. Então tente.”</b>
    </div>

    <nav>
      <button class="tab" data-tab="links">Links</button>
      <button class="tab" data-tab="sorteio">Sorteio</button>
      <button class="tab" data-tab="luta1">Luta 1x1</button>
      <button class="tab" data-tab="luta2">Luta 2x2</button>
      <button class="tab" data-tab="campanha">Campanha</button>
      <button class="tab" data-tab="ranking">Ranking</button>
      <button class="tab" id="musicBtn">♪ Música</button>
    </nav>
  </header>

  <main>
    <!-- LINKS -->
    <section class="panel active" id="tab-links">
      <div class="panelTop">
        <div>
          <div class="label">Links do Juliusagosto</div>
          <div class="muted">Clique e abre (com efeito “sharingan” fake). Só o nome da rede + o link.</div>
        </div>
        <div class="chip">link-in-bio</div>
      </div>

      <div class="panelBody grid2">
        <div class="box">
          <div class="label">Redes sociais</div>
          <div class="muted" style="margin-top: 6px;">
            <div><b>Instagram:</b> <a href="https://www.instagram.com/juliogabrielcharaodafontoura?igsh=dGhncWNwemdyazBw" target="_blank" class="openLink">abrir</a></div>
            <div><b>Facebook:</b> <a href="https://www.facebook.com/share/1G4e4LMbsM/" target="_blank" class="openLink">abrir</a></div>
            <div><b>YouTube:</b> <a href="https://www.youtube.com/@TobinhoAgosto" target="_blank" class="openLink">abrir</a></div>
            <div><b>TikTok:</b> <a href="https://www.tiktok.com/@juliusagosto1983?_r=1&_t=ZS-927AgmpsQVh" target="_blank" class="openLink">abrir</a></div>
            <div><b>Discord:</b> <a href="https://discord.gg/QHQeCXVE" target="_blank" class="openLink">abrir</a></div>
            <div><b>Twitch:</b> <a href="https://m.twitch.tv/juliusagosto/home?tt_content=channel&tt_medium=mobile_web_share" target="_blank" class="openLink">abrir</a></div>
          </div>
        </div>

        <div class="box">
          <div class="label">Contato / Pix</div>
          <div class="muted" style="margin-top: 6px;">
            <div><b>E-mail (pix):</b> juliusagosto1983@gmail.com</div>
            <div><b>Número:</b> (51) 98014-8072</div>
          </div>
        </div>
      </div>
    </section>

    <!-- SORTEIO -->
    <section class="panel" id="tab-sorteio">
      <div class="panelTop">
        <div>
          <div class="label">Sorteio de poderes (3 universos)</div>
          <div class="muted">Você recebe: <b>Anime</b> + <b>Séries/Filmes</b> + <b>Livros</b>. Cada poder vem com raridade (do básico ao super lendário).</div>
        </div>
        <div class="chip">gacha</div>
      </div>

      <div class="panelBody grid2">
        <div class="box">
          <div class="label">Seu nome (para o ranking)</div>
          <input id="playerName" value="Juliusagosto" />
          <button class="btn" id="btnSorteio">Sortear (3 poderes)</button>
          <div id="outSorteio" class="result" style="display:none;"></div>
        </div>

        <div class="box">
          <div class="label">Frase (mistura com seu nome)</div>
          <div id="outFrase" class="result" style="display:none;"></div>
          <div class="mini" style="margin-top: 8px;">Dica: cada rank desbloqueia frases novas (e elas aparecem aqui também).</div>
        </div>
      </div>
    </section>

    <!-- LUTA 1x1 -->
    <section class="panel" id="tab-luta1">
      <div class="panelTop">
        <div>
          <div class="label">Luta 1x1 (com poderes + diálogo)</div>
          <div class="muted">Cada lutador recebe 3 poderes (anime / séries-filmes / livros). A vitória/derrota gera frases do estilo “lhe falta ódio” ou “foi muito difícil”.</div>
        </div>
        <div class="chip">arena</div>
      </div>

      <div class="panelBody grid2">
        <div class="box">
          <div class="label">Nomes</div>
          <input id="p1" value="Juliusagosto" />
          <div style="height:8px"></div>
          <input id="p2" value="Kaito" />
          <button class="btn" id="btn1v1">Batalhar 1x1</button>
          <div id="out1v1" class="result" style="display:none;"></div>
        </div>

        <div class="box">
          <div class="label">Regras rápidas</div>
          <div class="muted" style="margin-top: 6px;">
            Força = somatório das raridades dos 3 poderes (com um toque de aleatório).<br/>
            Vitória dá <b> +30 RP</b> (subir de rank). Derrota dá <b> +12 RP</b> (pra você sempre avançar).
          </div>
        </div>
      </div>
    </section>

    <!-- LUTA 2x2 -->
    <section class="panel" id="tab-luta2">
      <div class="panelTop">
        <div>
          <div class="label">Luta 2x2 (duplas)</div>
          <div class="muted">Dois contra dois: cada pessoa recebe 3 poderes, e a dupla soma a força. O diálogo mistura os nomes do jeito que você pediu.</div>
        </div>
        <div class="chip">team</div>
      </div>

      <div class="panelBody grid2">
        <div class="box">
          <div class="label">Dupla A</div>
          <input id="a1" value="Juliusagosto" />
          <div style="height:8px"></div>
          <input id="a2" value="Rin" />
          <div style="height:10px"></div>

          <div class="label">Dupla B</div>
          <input id="b1" value="Kaito" />
          <div style="height:8px"></div>
          <input id="b2" value="Mika" value="Mika" />
          <button class="btn" id="btn2v2">Batalhar 2x2</button>
          <div id="out2v2" class="result" style="display:none;"></div>
        </div>

        <div class="box">
          <div class="label">Regras rápidas</div>
          <div class="muted" style="margin-top: 6px;">
            Vitória da dupla dá <b>+45 RP</b> (e o nome do time vencedor vira “titular” do round).<br/>
            Derrota dá <b>+18 RP</b> (pra você continuar evoluindo, mesmo quando perde).
          </div>
        </div>
      </div>
    </section>

    <!-- CAMPANHA -->
    <section class="panel" id="tab-campanha">
      <div class="panelTop">
        <div>
          <div class="label">Campanha (modo torneio)</div>
          <div class="muted">Você enfrenta 5 oponentes em sequência (ficam mais fortes). Ganhar sobe rank e desbloqueia frases novas.</div>
        </div>
        <div class="chip">story</div>
      </div>

      <div class="panelBody grid2">
        <div class="box">
          <div class="label">Progresso da campanha</div>
          <div id="campStatus" class="muted" style="margin-top:6px;"></div>
          <button class="btn" id="btnCamp">Batalhar fase atual</button>
          <div id="outCamp" class="result" style="display:none;"></div>
        </div>

        <div class="box">
          <div class="label">Recompensas</div>
          <div class="muted" style="margin-top: 6px;">
            Cada vitória dá RP + uma frase nova do nível atual. No final (5 vitórias) você ganha o status <b>Lendário</b> e desbloqueia o pack de frases mais “insano”.
          </div>
        </div>
      </div>
    </section>

    <!-- RANKING -->
    <section class="panel" id="tab-ranking">
      <div class="panelTop">
        <div>
          <div class="label">Ranking (seu progresso)</div>
          <div class="muted">Aqui aparecem seu rank, RP e o “último resultado” (sorteio/luta/campanha).</div>
        </div>
        <div class="chip">rank</div>
      </div>

      <div class="panelBody grid2">
        <div class="box">
          <div class="label">Seu perfil</div>
          <div id="profile" class="muted" style="margin-top: 6px;"></div>
        </div>
        <div class="box">
          <div class="label">Último evento</div>
          <div id="lastEvent" class="muted" style="margin-top: 6px;"></div>
          <div class="mini" style="margin-top: 8px;">Dica: troque o nome no campo do sorteio e o sistema atualiza tudo (mas o RP continua salvo).</div>
        </div>
      </div>
    </section>
  </main>

  <!-- efeito "sharingan" (falso) para cliques de link -->
  <div class="share-veil" id="veil"><div class="share-ring"></div></div>

  <script>
    /* =========================
       Utilidades / Persistência
    ========================= */
    const STORAGE_KEY = "juliusagosto_portal_v2";

    const defaultState = {
      name: "Juliusagosto",
      rp: 0,
      rank: "Iniciante",
      camp: { stage: 0, wins: 0 },
      last: { type: "none", text: "" }
    };

    function loadState(){
      try { return { ...defaultState, ...(JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}) }; }
      catch { return { ...defaultState }; }
    }
    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    let state = loadState();

    function setNameFromInput(){
      const v = (document.getElementById("playerName").value || "").trim();
      if(v) state.name = v;
      state.name = state.name || "Juliusagosto";
      saveState();
    }

    /* =========================
       Tabs (funcionando de verdade)
    ========================= */
    const panels = {
      links: document.getElementById("tab-links"),
      sorteio: document.getElementById("tab-sorteio"),
      luta1: document.getElementById("tab-luta1"),
      luta2: document.getElementById("tab-luta2"),
      campanha: document.getElementById("tab-campanha"),
      ranking: document.getElementById("tab-ranking"),
    };

    function showTab(id){
      Object.values(panels).forEach(p => p.classList.remove("active"));
      panels[id].classList.add("active");
    }

    document.querySelectorAll(".tab").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-tab");
        if(id) showTab(id);
      });
    });

    /* =========================
       Música (lo-fi) — ligar/desligar
    ========================= */
    let musicOn = false;
    let audioCtx = null;
    let musicTimer = null;

    function toggleMusic(){
      if(!musicOn) startMusic(); else stopMusic();
    }

    document.getElementById("musicBtn").addEventListener("click", toggleMusic);

    function startMusic(){
      const AC = window.AudioContext || window.webkitAudioContext;
      if(!AC) return;
      if(!audioCtx) audioCtx = new AC();

      musicOn = true;
      const bpm = 72, beat = 60000 / bpm;

      const make = (type, freq, gain) => {
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type; o.frequency.value = freq; g.gain.value = gain;
        o.connect(g); g.connect(audioCtx.destination);
        return {o,g};
      };

      let t = 0;
      musicTimer = setInterval(() => {
        // kick bem suave
        let k = make("sine", 80, 0.03); k.o.start(); k.o.stop(audioCtx.currentTime + 0.08);

        // bassinho
        let b = make("triangle", 55 + (t%2===0 ? 0 : 3), 0.02);
        b.o.start(); b.o.stop(audioCtx.currentTime + 0.22);

        // melodia leve
        const notes = [220, 262, 294, 330];
        let m = make("sine", notes[t % notes.length], 0.015);
        m.o.start(); m.o.stop(audioCtx.currentTime + 0.22);

        t++;
      }, beat);
    }

    function stopMusic(){
      musicOn = false;
      if(musicTimer){ clearInterval(musicTimer); musicTimer = null; }
    }

    /* =========================
       “Sharingan” fake para links
    ========================= */
    const veil = document.getElementById("veil");
    function openWithEffect(url){
      veil.classList.add("active");
      setTimeout(() => {
        veil.classList.remove("active");
        window.open(url, "_blank", "noopener,noreferrer");
      }, 420);
    }

    document.querySelectorAll(".openLink").forEach(a => {
      a.addEventListener("click", (e) => {
        e.preventDefault();
        openWithEffect(a.href);
      });
    });

    /* =========================
       Bancos (30+ itens por universo)
    ========================= */
    const UNIV = {
      anime: [
        "Naruto","Dragon Ball","My Hero Academia","Hunter x Hunter","Attack on Titan",
        "Demon Slayer","One Piece","Jujutsu Kaisen","Bleach","Fullmetal Alchemist",
        "Tokyo Ghoul","Death Note","Fairy Tail","One Punch Man","Mob Psycho",
        "Chainsaw Man","Haikyuu!!","Sword Art Online","Re:Zero","Dr. Stone",
        "Vinland Saga","Boruto","Black Clover","Neon Genesis Evangelion","Trigun",
        "Cowboy Bebop","Yu Yu Hakusho","Soul Eater","Gintama","Fate/Stay Night"
      ],
      series: [
        "Stranger Things","The Witcher","Breaking Bad","Game of Thrones","Arcane",
        "The Boys","Loki","Invincible","Daredevil","The Mandalorian",
        "Peaky Blinders","Sherlock","Dark","Cobra Kai","Castlevania",
        "Vikings","The Umbrella Academy","Wednesday","Halo","Sons of Anarchy",
        "The Expanse","Westworld","Hawkeye","Titans","Star Trek",
        "The Flash","Supergirl","Arrow","Black Mirror","The Crown"
      ],
      books: [
        "Harry Potter","Percy Jackson","The Hunger Games","Divergent","Mistborn",
        "The Wheel of Time","Dune","Eragon","The Name of the Wind","The Kingkiller Chronicle",
        "Fablehaven","The Chronicles of Narnia","The Hobbit","Lord of the Rings","A Song of Ice and Fire",
        "Ready Player One","Ender’s Game","The Maze Runner","The Giver","American Gods",
        "Good Omens","The Stormlight Archive","Foundation","Red Rising","Six of Crows",
        "The Dark Tower","Neverwhere","The Shadow of the Wind","Coraline","The Golden Compass"
      ],
      cartoons: [
        "Ben 10","Avatar: The Last Airbender","Teen Titans","Gravity Falls","Rick and Morty",
        "Adventure Time","Steven Universe","Samurai Jack","Voltron","Miraculous",
        "Teenage Mutant Ninja Turtles","The Amazing World of Gumball","Star vs. the Forces of Evil","Futurama","Regular Show",
        "SpongeBob","Dexter’s Laboratory","The Simpsons","Family Guy","South Park",
        "Kim Possible","The Powerpuff Girls","Generator Rex","X-Men (cartoon)","Justice League",
        "Batman: The Animated Series","Dragon Ball (cartoon)","Star Wars: Rebels","Transformers","Pokémon"
      ]
    };

    const RAR = [
      { name: "Básico", weight: 1 },
      { name: "Médio",  weight: 2 },
      { name: "Raro",   weight: 3 },
      { name: "Épico",  weight: 4 },
      { name: "Lendário", weight: 5 },
      { name: "Super Lendário", weight: 6 }
    ];

    const POWER_TEMPLATES = [
      "Golpe de energia concentrada",
      "Passo fantasma (velocidade)",
      "Escudo de recuperação instantânea",
      "Explosão de pressão curta",
      "Projeção de aura + foco",
      "Contra-ataque perfeito (um golpe)",
      "Controle do ambiente por 3 segundos",
      "Pressão mental (curta duração)",
      "Transformação temporária de força",
      "Finalização de precisão (golpe final)"
    ];

    function rnd(arr){ return arr[Math.floor(Math.random() * arr.length)]; }

    function drawRarity(){
      // probabilidade: mais comum ser básico; raro/épico existem mas não dominam
      const roll = Math.random();
      if(roll < .38) return RAR[0];
      if(roll < .66) return RAR[1];
      if(roll < .86) return RAR[2];
      if(roll < .95) return RAR[3];
      if(roll < .99) return RAR[4];
      return RAR[5];
    }

    function makePower(universeKey){
      const obra = rnd(UNIV[universeKey]);
      const r = drawRarity();
      return {
        universe: universeKey,
        obra,
        name: rnd(POWER_TEMPLATES),
        rarity: r.name,
        weight: r.weight
      };
    }

    function makeKit(){
      // 3 poderes: Anime + Séries/Filmes + Livros (o que você pediu)
      return [ makePower("anime"), makePower("series"), makePower("books") ];
    }

    function makeFighter(name){
      const kit = makeKit();
      const strength = kit.reduce((s,p)=> s + p.weight, 0) + (Math.random() < .5 ? 0 : 1);
      return { name, kit, strength };
    }

    /* =========================
       Frases (desbloqueiam por rank)
    ========================= */
    const PHRASE_PACKS = {
      "Iniciante": [
        "Respira. Foca. Vai de novo — e dessa vez entra com tudo.",
        "Se travou, não é derrota: é tutorial do próximo nível.",
        "Força não é gritar: é continuar mesmo quando o coração treme."
      ],
      "Ascendente": [
        "A próxima vitória já tá no teu próximo esforço.",
        "Pega o golpe, aprende e volta com a estratégia certa.",
        "Quem insiste um passo a mais vira protagonista."
      ],
      "Domínio": [
        "Você não tá jogando: você tá evoluindo em tempo real.",
        "O mundo pode cair, mas você se reestrutura mais forte.",
        "Quando duvidam, é sinal de que seu avanço tá doendo neles."
      ],
      "Lendário": [
        "Você virou a própria prova de que persistência vence.",
        "A lenda não nasce pronta — ela é construída na sequência de tentativas.",
        "Se o alvo é o sonho, o caminho é uma treino infinito."
      ]
    };

    function rankFromRP(rp){
      if(rp >= 260) return "Lendário";
      if(rp >= 140) return "Domínio";
      if(rp >= 60)  return "Ascendente";
      return "Iniciante";
    }

    function refreshRank(){
      state.rank = rankFromRP(state.rp);
      saveState();
      updateRankingUI();
    }

    /* =========================
       Diálogos de luta (vitória/derrota) - com o estilo que você pediu
    ========================= */
    function victoryLine(winner, loser){
      const lines = [
        `“Foi muito fácil ganhar deles.” — ${winner}`,
        `“Lhe falta ódio, ${loser}.” — ${winner}`,
        `“Eu avisei: se eu perco, eu volto mais forte.” — ${winner}`,
        `“Você tentou… mas eu já tava um passo na frente.” — ${winner}`
      ];
      return rnd(lines);
    }

    function defeatLine(loser, winner){
      const lines = [
        `“Nossa… foi muito difícil. A gente perdeu.” — ${loser}`,
        `“A gente deu tudo, mas o golpe final foi deles.” — ${loser}`,
        `“Demoramos pra entrar no ritmo… e acabou.” — ${loser}`,
        `“Eles foram melhores hoje. Próxima eu volto diferente.” — ${loser}`
      ];
      return rnd(lines);
    }

    /* =========================
       UI helpers (render)
    ========================= */
    function renderKit(kit){
      return `<ul style="margin:6px 0 0 18px; text-align:left;">
        ${kit.map(p => `<li><b>${p.universe.toUpperCase()}:</b> ${p.obra} — ${p.name} <span class="mini">(${p.rarity})</span></li>`).join("")}
      </ul>`;
    }

    function updateRankingUI(){
      document.getElementById("profile").innerHTML =
        `<div class="label">${state.name}</div>
         <div class="muted" style="margin-top:6px;">
           Rank: <b>${state.rank}</b> · RP: <b>${state.rp}</b>
         </div>`;

      document.getElementById("lastEvent").innerHTML =
        state.last.text ? `<div class="muted">${state.last.text}</div>` :
        `<div class="muted">Sem evento recente ainda — faça um sorteio ou uma luta.</div>`;
    }

    /* =========================
       Ações: Sorteio / Lutas / Campanha
    ========================= */
    function doSorteio(){
      setNameFromInput();
      state.rank = rankFromRP(state.rp);

      const fighter = makeFighter(state.name);

      // frase do seu rank (mistura do seu nome)
      const pack = PHRASE_PACKS[state.rank] || PHRASE_PACKS["Iniciante"];
      const phrase = rnd(pack).replace(/você/gi, state.name);

      document.getElementById("outSorteio").style.display = "block";
      document.getElementById("outSorteio").innerHTML =
        `<div class="label">Ranking Juliusagosto (força): <b>${fighter.strength}</b></div>
         <div class="muted" style="margin-top:6px;">${renderKit(fighter.kit)}</div>`;

      document.getElementById("outFrase").style.display = "block";
      document.getElementById("outFrase").innerHTML = `<div class="muted">${phrase}</div>`;

      state.last = { type:"sorteio", text: `Sorteio de poderes para ${state.name} (rank: ${state.rank}).` };
      saveState();
      updateRankingUI();
    }

    function do1v1(){
      setNameFromInput();
      const n1 = (document.getElementById("p1").value || "Juliusagosto").trim();
      const n2 = (document.getElementById("p2").value || "Kaito").trim();

      const A = makeFighter(n1);
      const B = makeFighter(n2);

      const winner = (A.strength >= B.strength) ? A : B;
      const loser  = (winner === A) ? B : A;

      // RP (você sempre evolui, mesmo se perder)
      const isPlayerWinner = (winner.name === state.name);
      state.rp += isPlayerWinner ? 30 : 12;
      refreshRank();

      document.getElementById("out1v1").style.display = "block";
      document.getElementById("out1v1").innerHTML = `
        <div class="label">RANK (1x1): ${A.name} [${A.strength}] vs ${B.name} [${B.strength}]</div>
        <div class="muted" style="margin-top:6px;">
          <b>${A.name}</b> — ${renderKit(A.kit)}
          <b>${B.name}</b> — ${renderKit(B.kit)}
        </div>
        <div class="result" style="margin-top:10px;">
          <div class="label">Diálogo</div>
          <div class="muted" style="margin-top:6px;">
            ${victoryLine(winner.name, loser.name)}<br/>
            ${defeatLine(loser.name, winner.name)}
          </div>
        </div>
      `;

      state.last = { type:"luta1", text: `1x1: ${winner.name} venceu ${loser.name} (RP agora: ${state.rp}, rank: ${state.rank}).` };
      saveState();
      updateRankingUI();
    }

    function do2v2(){
      setNameFromInput();
      const A1 = (document.getElementById("a1").value || "Juliusagosto").trim();
      const A2 = (document.getElementById("a2").value || "Rin").trim();
      const B1 = (document.getElementById("b1").value || "Kaito").trim();
      const B2 = (document.getElementById("b2").value || "Mika").trim();

      const pA1 = makeFighter(A1), pA2 = makeFighter(A2);
      const pB1 = makeFighter(B1), pB2 = makeFighter(B2);

      const forceA = pA1.strength + pA2.strength;
      const forceB = pB1.strength + pB2.strength;

      const winnerPair = (forceA >= forceB) ? { name: `${A1} + ${A2}`, force: forceA } : { name: `${B1} + ${B2}`, force: forceB };
      const loserPair  = (forceA >= forceB) ? { name: `${B1} + ${B2}`, force: forceB } : { name: `${A1} + ${A2}`, force: forceA };

      const playerInWinner = winnerPair.name.includes(state.name);
      state.rp += playerInWinner ? 45 : 18;
      refreshRank();

      document.getElementById("out2v2").style.display = "block";
      document.getElementById("out2v2").innerHTML = `
        <div class="label">RANK (2x2): ${A1}+${A2} [${forceA}] vs ${B1}+${B2} [${forceB}]</div>
        <div class="muted" style="margin-top:6px;">
          <b>${A1}</b> — ${renderKit(pA1.kit)}
          <b>${A2}</b> — ${renderKit(pA2.kit)}
          <b>${B1}</b> — ${renderKit(pB1.kit)}
          <b>${B2}</b> — ${renderKit(pB2.kit)}
        </div>
        <div class="result" style="margin-top:10px;">
          <div class="label">Diálogo</div>
          <div class="muted" style="margin-top:6px;">
            ${victoryLine(winnerPair.name, loserPair.name)}<br/>
            ${defeatLine(loserPair.name, winnerPair.name)}
          </div>
        </div>
      `;

      state.last = { type:"luta2", text: `2x2: venceu ${winnerPair.name} (RP: ${state.rp}, rank: ${state.rank}).` };
      saveState();
      updateRankingUI();
    }

    /* =========================
       Campanha (torneio 5 fases)
    ========================= */
    const CAMPAIGN = [
      { name:"Kuro", base: 6 },
      { name:"Sora", base: 9 },
      { name:"Mika", base: 12 },
      { name:"Rin",  base: 15 },
      { name:"Kaito", base: 18 }
    ];

    function updateCampStatus(){
      const st = state.camp.stage;
      const w  = state.camp.wins;
      const next = CAMPAIGN[Math.min(st, CAMPAIGN.length-1)];
      document.getElementById("campStatus").innerHTML =
        `<div class="muted">Fase: <b>${Math.min(st+1, CAMPAIGN.length)}</b> / ${CAMPAIGN.length} · Vitórias: <b>${w}</b> — Próximo oponente: <b>${next.name}</b></div>`;
    }

    function doCamp(){
      setNameFromInput();

      const idx = Math.min(state.camp.stage, CAMPAIGN.length-1);
      const enemy = CAMPAIGN[idx];

      // jogador do usuário recebe kit normal; inimigo recebe kit com bônus (base)
      const me = makeFighter(state.name);
      me.strength += 2; // pequena vantagem do “protagonista” (bem justa)
      const foe = makeFighter(enemy.name);
      foe.strength += enemy.base;

      const winner = (me.strength >= foe.strength) ? me : foe;
      const loser  = (winner === me) ? foe : me;

      const playerWon = (winner.name === state.name);
      state.rp += playerWon ? 38 : 14;
      if(playerWon) state.camp.wins += 1;
      state.camp.stage = Math.min(state.camp.stage + 1, CAMPAIGN.length); // avança sempre (pra não travar o usuário)

      refreshRank();
      updateCampStatus();

      document.getElementById("outCamp").style.display = "block";
      document.getElementById("outCamp").innerHTML = `
        <div class="label">Campanha — Fase ${Math.min(idx+1, CAMPAIGN.length)}</div>
        <div class="muted" style="margin-top:6px;">
          <b>${me.name}</b> [${me.strength}] vs <b>${foe.name}</b> [${foe.strength}]
        </div>
        <div class="result" style="margin-top:10px;">
          <div class="label">Diálogo</div>
          <div class="muted" style="margin-top:6px;">
            ${victoryLine(winner.name, loser.name)}<br/>
            ${defeatLine(loser.name, winner.name)}
          </div>
        </div>
      `;

      state.last = { type:"campanha", text: `Campanha: fase ${idx+1} concluída. Rank: ${state.rank}, RP: ${state.rp}.` };
      saveState();
      updateRankingUI();
    }

    /* =========================
       Init (liga tudo)
    ========================= */
    document.getElementById("playerName").value = state.name;
    document.getElementById("btnSorteio").addEventListener("click", doSorteio);
    document.getElementById("btn1v1").addEventListener("click", do1v1);
    document.getElementById("btn2v2").addEventListener("click", do2v2);
    document.getElementById("btnCamp").addEventListener("click", doCamp);

    // render inicial do ranking e campanha
    refreshRank();
    updateCampStatus();
  </script>
</body>
</html>